"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[975],{6628:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var a=s(7179),r=s(3058),i=s(5223),n=s(6904),l=s(2469),o=s(3333),d=s(6878),u=s(3165),c=s(7233),h=s(5251),p=function(){var e=this,t=e._self._c;return t(l.Z,{attrs:{src:s(4910),height:"100vh"}},[t("div",{staticClass:"d-flex justify-center align-center",staticStyle:{height:"100%"}},[t(r.Z,{staticClass:"pa-6",staticStyle:{opacity:"0.9"},attrs:{width:"600px",elevation:"1",outlined:"",rounded:"xl"}},[t(i.ZB,[t(u.Z,{attrs:{grow:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(o.Z,[e._v("登录")]),t(o.Z,[e._v("注册")])],1),t(c.Z,{staticClass:"pt-12",model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(d.Z,[t(n.Z,{ref:"formValidLogin",model:{value:e.validLogin,callback:function(t){e.validLogin=t},expression:"validLogin"}},[t(h.Z,{attrs:{rounded:"",filled:"",label:"请输入工号",rules:[e.notNullRule,e.onlyNumRule]},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()}},model:{value:e.workId,callback:function(t){e.workId=t},expression:"workId"}}),t(h.Z,{attrs:{rounded:"",filled:"",label:"请输入密码",rules:[e.notNullRule],"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password"},on:{"click:append":function(t){e.showPassword=!e.showPassword},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("div",{staticClass:"d-flex justify-end"},[t(a.Z,{staticClass:"mr-3",attrs:{rounded:"",dark:"",color:"red","x-large":""},on:{click:function(t){return e.$refs.formValidLogin.reset()}}},[e._v("清除")]),t(a.Z,{attrs:{rounded:"",dark:"",color:"green","x-large":""},on:{click:function(t){return e.login()}}},[e._v("登入")])],1)],1)],1),t(d.Z,[t(n.Z,{ref:"formValidRegister",model:{value:e.validRegister,callback:function(t){e.validRegister=t},expression:"validRegister"}},[t(h.Z,{attrs:{rounded:"",filled:"",label:"请输入工号",rules:[e.notNullRule,e.onlyNumRule]},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register()}},model:{value:e.workId,callback:function(t){e.workId=t},expression:"workId"}}),t(h.Z,{attrs:{rounded:"",filled:"",label:"请输入密码",rules:[e.notNullRule],"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password"},on:{"click:append":function(t){e.showPassword=!e.showPassword},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t(h.Z,{attrs:{rounded:"",filled:"",label:"请输入姓名",rules:[e.notNullRule]},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("div",{staticClass:"d-flex justify-end"},[t(a.Z,{staticClass:"mr-3",attrs:{rounded:"",dark:"",color:"red","x-large":""},on:{click:function(t){return e.$refs.formValidRegister.reset()}}},[e._v("清除")]),t(a.Z,{attrs:{rounded:"",dark:"",color:"green","x-large":""},on:{click:function(t){return e.register()}}},[e._v("注册")])],1)],1)],1)],1)],1)],1)],1),t("Snackbar",{ref:"snackbar"})],1)},m=[],f=(s(7658),s(8293)),k={components:{Snackbar:f.Z},data:()=>({tab:"",validLogin:!1,validRegister:!1,workId:"",password:"",username:"",showPassword:!1,notNullRule:e=>!!e||"不能为空",onlyNumRule:e=>/^\d+$/.test(e)||"只能为数字"}),methods:{async register(){try{const e=await this.$axios({method:"post",url:"/userValidRepeat",data:{workId:this.workId}});"注册成功待审批"===e.data?(await this.$axios({method:"post",url:"/userAdd",data:{workId:this.workId,password:this.password,username:this.username}}),this.$refs.snackbar.snackbarStatus="info",this.$refs.snackbar.snackbarText="注册成功待审批",this.$refs.snackbar.snackbarShow=!0):"工号已存在"===e.data&&(this.$refs.snackbar.snackbarStatus="error",this.$refs.snackbar.snackbarText="工号已存在",this.$refs.snackbar.snackbarShow=!0)}catch(e){console.log(e)}},async login(){const e=await this.$axios({method:"post",url:"/userLogin",data:{workId:this.workId,password:this.password}});if("登入成功"===e.data){const e=await this.$axios({method:"post",url:"/userGetInfo",data:{workId:this.workId}});this.$refs.snackbar.snackbarStatus="info",this.$refs.snackbar.snackbarText="登入成功",this.$refs.snackbar.snackbarShow=!0,localStorage.setItem("username",e.data[0].username),localStorage.setItem("workId",e.data[0].workId),localStorage.setItem("rating",e.data[0].rating),setTimeout((()=>{this.$router.push("/index")}),1500)}else"登入失败"===e.data&&(this.$refs.snackbar.snackbarStatus="error",this.$refs.snackbar.snackbarText="账号待审批/工号不存在/密码错误",this.$refs.snackbar.snackbarShow=!0)}}},g=k,y=s(1001),w=(0,y.Z)(g,p,m,!1,null,null,null),v=w.exports},2021:function(e,t,s){s.d(t,{y:function(){return o}});s(7658);var a=s(564),r=s(3939),i=s(3276),n=s(4987),l=s(6596);const o=(0,n.Z)(a.Z,r.Z,i.Z).extend({name:"base-item-group",props:{activeClass:{type:String,default:"v-item--active"},mandatory:Boolean,max:{type:[Number,String],default:null},multiple:Boolean,tag:{type:String,default:"div"}},data(){return{internalLazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,items:[]}},computed:{classes(){return{"v-item-group":!0,...this.themeClasses}},selectedIndex(){return this.selectedItem&&this.items.indexOf(this.selectedItem)||-1},selectedItem(){if(!this.multiple)return this.selectedItems[0]},selectedItems(){return this.items.filter(((e,t)=>this.toggleMethod(this.getValue(e,t))))},selectedValues(){return null==this.internalValue?[]:Array.isArray(this.internalValue)?this.internalValue:[this.internalValue]},toggleMethod(){if(!this.multiple)return e=>this.valueComparator(this.internalValue,e);const e=this.internalValue;return Array.isArray(e)?t=>e.some((e=>this.valueComparator(e,t))):()=>!1}},watch:{internalValue:"updateItemsState",items:"updateItemsState"},created(){this.multiple&&!Array.isArray(this.internalValue)&&(0,l.Kd)("Model must be bound to an array if the multiple property is true.",this)},methods:{genData(){return{class:this.classes}},getValue(e,t){return void 0===e.value?t:e.value},onClick(e){this.updateInternalValue(this.getValue(e,this.items.indexOf(e)))},register(e){const t=this.items.push(e)-1;e.$on("change",(()=>this.onClick(e))),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(e,t)},unregister(e){if(this._isDestroyed)return;const t=this.items.indexOf(e),s=this.getValue(e,t);this.items.splice(t,1);const a=this.selectedValues.indexOf(s);if(!(a<0)){if(!this.mandatory)return this.updateInternalValue(s);this.multiple&&Array.isArray(this.internalValue)?this.internalValue=this.internalValue.filter((e=>e!==s)):this.internalValue=void 0,this.selectedItems.length||this.updateMandatory(!0)}},updateItem(e,t){const s=this.getValue(e,t);e.isActive=this.toggleMethod(s)},updateItemsState(){this.$nextTick((()=>{if(this.mandatory&&!this.selectedItems.length)return this.updateMandatory();this.items.forEach(this.updateItem)}))},updateInternalValue(e){this.multiple?this.updateMultiple(e):this.updateSingle(e)},updateMandatory(e){if(!this.items.length)return;const t=this.items.slice();e&&t.reverse();const s=t.find((e=>!e.disabled));if(!s)return;const a=this.items.indexOf(s);this.updateInternalValue(this.getValue(s,a))},updateMultiple(e){const t=Array.isArray(this.internalValue)?this.internalValue:[],s=t.slice(),a=s.findIndex((t=>this.valueComparator(t,e)));this.mandatory&&a>-1&&s.length-1<1||null!=this.max&&a<0&&s.length+1>this.max||(a>-1?s.splice(a,1):s.push(e),this.internalValue=s)},updateSingle(e){const t=this.valueComparator(this.internalValue,e);this.mandatory&&t||(this.internalValue=t?void 0:e)}},render(e){return e(this.tag,this.genData(),this.$slots.default)}});o.extend({name:"v-item-group",provide(){return{itemGroup:this}}})},7601:function(e,t,s){var a=s(6596),r=s(144);t.Z=r.ZP.extend().extend({name:"bootable",props:{eager:Boolean},data:()=>({isBooted:!1}),computed:{hasContent(){return this.isBooted||this.eager||this.isActive}},watch:{isActive(){this.isBooted=!0}},created(){"lazy"in this.$attrs&&(0,a.Jk)("lazy",this)},methods:{showLazyContent(e){return this.hasContent&&e?e():[this.$createElement()]}}})},564:function(e,t,s){var a=s(144),r=s(1050);t.Z=a.ZP.extend({name:"comparable",props:{valueComparator:{type:Function,default:r.vZ}}})},4910:function(e,t,s){e.exports=s.p+"img/login.ecd850ae.jpg"}}]);
//# sourceMappingURL=975.9facd1bc.js.map